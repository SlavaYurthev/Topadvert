<?xml version="1.0" ?>
<config>
	<modules>
		<SY_Topadvert>
			<version>0.0.1</version>
		</SY_Topadvert>
	</modules>
	<global>
		<blocks>
			<topadvert>
				<class>SY_Topadvert_Block</class>
			</topadvert>
		</blocks>
		<helpers>
			<topadvert>
				<class>SY_Topadvert_Helper</class>
			</topadvert>
		</helpers>
		<models>
			<topadvert>
				<class>SY_Topadvert_Model</class>
			</topadvert>
		</models>
		<resources>
			<topadvert_setup>
				<setup>
					<module>SY_Topadvert</module>
				</setup>
			</topadvert_setup>
		</resources>
		<events>
			<sales_model_service_quote_submit_before>
				<observers>
					<topadvert_before_order_save>
						<type>model</type>
						<class>topadvert/observer</class>
						<method>beforeOrderSave</method>
					</topadvert_before_order_save>
				</observers>
			</sales_model_service_quote_submit_before>
			<sales_order_place_after>
				<observers>
					<topadvert_generate_yml_after_place_order>
						<type>model</type>
						<class>topadvert/observer</class>
						<method>generateYMLAfterPlaceOrder</method>
					</topadvert_generate_yml_after_place_order>
				</observers>
			</sales_order_place_after>
			<controller_action_layout_load_before>
				<observers>
					<topadvert_detect_incomming>
						<type>model</type>
						<class>topadvert/observer</class>
						<method>entry</method>
					</topadvert_detect_incomming>
				</observers>
			</controller_action_layout_load_before>
		</events>
	</global>
	<adminhtml>
		<layout>
			<updates>
				<topadvert>
					<file>sy/topadvert.xml</file>
				</topadvert>
			</updates>
		</layout>
		<translate>
			<modules>
				<topadvert>
					<files>
						<default>SY/Topadvert.csv</default>
					</files>
				</topadvert>
			</modules>
		</translate>
		<acl>
			<resources>
				<admin>
					<children>
						<system>
							<children>
								<config>
									<children>
										<topadvert_options translate="title">
											<title>Topadvert Options</title>
											<sort_order>1</sort_order>
										</topadvert_options>
									</children>
								</config>
							</children>
						</system>
					</children>
				</admin>
			</resources>
		</acl>
	</adminhtml>
	<crontab>
		<jobs>
			<topadvert_generate_yml>
				<schedule>
					<config_path>topadvert_options/yml/frequency</config_path>
				</schedule>
				<run>
					<model>topadvert/observer::generateYML</model>
				</run>
			</topadvert_generate_yml>
			<topadvert_generate_price_list>
				<schedule>
					<config_path>topadvert_options/price_list/frequency</config_path>
				</schedule>
				<run>
					<model>topadvert/observer::generatePriceList</model>
				</run>
			</topadvert_generate_price_list>
		</jobs>
	</crontab>
	<default>
		<topadvert_options>
			<general>
				<active>1</active>
			</general>
			<money>
				<type>1</type>
				<value>0</value>
			</money>
			<yml>
				<frequency>0 * * * *</frequency>
				<path>topadvert.yml</path>
				<period>all</period>
				<update_after_place_order>1</update_after_place_order>
			</yml>
			<price_list>
				<frequency>0 0 * * *</frequency>
				<path>price-list.yml</path>
			</price_list>
			<developer>
				<developer>Slava Yurthev</developer>
			</developer>
		</topadvert_options>
	</default>
</config>